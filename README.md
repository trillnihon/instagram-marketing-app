# Instagram Marketing App

## ğŸš€ æœ¬ç•ªãƒªãƒªãƒ¼ã‚¹å®Œäº† âœ…

**âœ… æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿ãƒ»å‹•ä½œç¢ºèªå®Œäº†**
- Vercel + Render ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®šå®Œäº†
- PWAå¯¾å¿œï¼ˆService Worker + Manifestï¼‰âœ… å‹•ä½œç¢ºèªæ¸ˆã¿
- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³å¯¾å¿œ
- å…¨ãƒ†ã‚¹ãƒˆï¼ˆãƒ¦ãƒ‹ãƒƒãƒˆ/çµ±åˆï¼‰ãƒ‘ã‚¹
- OpenAI APIé€£æº
- Facebook Login for Businessèªè¨¼
- **SPAãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°404å•é¡Œè§£æ±ºæ¸ˆã¿** âœ…
- **æŠ•ç¨¿æ™‚é–“åˆ†ææ©Ÿèƒ½å®Ÿè£…å®Œäº†** âœ…

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤

### é–‹ç™ºç’°å¢ƒ
```bash
npm run dev
# http://localhost:3001/login ã§ã‚¢ã‚¯ã‚»ã‚¹
```

### æœ¬ç•ªç’°å¢ƒ
```bash
# è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆGitHubé€£æºï¼‰
git push origin main

# æ‰‹å‹•ãƒ‡ãƒ—ãƒ­ã‚¤
vercel --prod
# https://instagram-marketing-app.vercel.app/login ã§ã‚¢ã‚¯ã‚»ã‚¹
```## ğŸš¨ é‡è¦ãªé€šçŸ¥

**Instagram Basic Display APIã¯2024å¹´12æœˆ4æ—¥ã«å»ƒæ­¢ã•ã‚Œã¾ã—ãŸã€‚**

- âŒ **Instagram Basic Display API**: æä¾›çµ‚äº†
- âœ… **Facebook Login for Business**: å®Ÿè£…å®Œäº†
- âœ… **ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰**: å¼•ãç¶šãåˆ©ç”¨å¯èƒ½

### ç¾åœ¨ã®å¯¾å¿œ
- Facebook Login for Businessã‚’ä½¿ç”¨
- Instagram Business Account / Creator Accountå‘ã‘
- å¿…è¦ãªæ¨©é™: `instagram_basic`, `instagram_content_publish`, `instagram_manage_comments`, `instagram_manage_insights`, `pages_show_list`, `pages_read_engagement`
- ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã‚‚å¼•ãç¶šãåˆ©ç”¨å¯èƒ½

## ğŸ“± ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ¦‚è¦

## ğŸ“‹ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

Instagram/ThreadsæŠ•ç¨¿åˆ†æãƒ»AIææ¡ˆSaaSã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

### ä¸»è¦æ©Ÿèƒ½
- âœ… AIæŠ•ç¨¿åˆ†æãƒ»æ”¹å–„ææ¡ˆ
- âœ… Threadsãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ
- âœ… æŠ•ç¨¿å±¥æ­´ç®¡ç†
- âœ… AIæŠ•ç¨¿æ–‡è‡ªå‹•ç”Ÿæˆ
- âœ… ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å¯¾å¿œã‚¢ãƒ‰ãƒã‚¤ã‚¹
- âœ… PWAå¯¾å¿œï¼ˆã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œï¼‰
- âœ… Facebook Login for Businessèªè¨¼
- âœ… Instagram Business Accounté€£æº
- âœ… **æŠ•ç¨¿æ™‚é–“åˆ†æãƒ»ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—æ©Ÿèƒ½**ï¼ˆæ–°æ©Ÿèƒ½ï¼‰
- âœ… **æœ€é©æŠ•ç¨¿æ™‚é–“æ¨å¥¨æ©Ÿèƒ½**ï¼ˆæ–°æ©Ÿèƒ½ï¼‰

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 1. ç’°å¢ƒæ§‹ç¯‰

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/trillnihon/instagram-marketing-app.git
cd instagram-marketing-app

# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev
```

### 2. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# æœ¬ç•ªãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰
./run-tests.sh

# å€‹åˆ¥ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm test                                    # å…¨ãƒ†ã‚¹ãƒˆ
npm run test:component                      # ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®ã¿
npm run test:api                           # çµ±åˆãƒ†ã‚¹ãƒˆã®ã¿
npm run test:coverage                      # ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆ
npm run verify                             # ãƒ“ãƒ«ãƒ‰ + ãƒ†ã‚¹ãƒˆæ¤œè¨¼
```

### 2. ç’°å¢ƒå¤‰æ•°è¨­å®š

#### é–‹ç™ºç’°å¢ƒï¼ˆ`env.development`ï¼‰
```env
# Facebook OAuthè¨­å®š
VITE_INSTAGRAM_APP_ID=1003724798254754
VITE_INSTAGRAM_APP_SECRET=14ad79e7973687a6e3f803024caaf5b9
VITE_INSTAGRAM_REDIRECT_URI=http://localhost:3001/auth/facebook/callback

# APIè¨­å®š
VITE_API_BASE_URL=http://localhost:4000/api

# ãƒ‡ãƒãƒƒã‚°è¨­å®š
VITE_DEBUG=true
```

#### æœ¬ç•ªç’°å¢ƒï¼ˆ`env.production`ï¼‰
```env
# Facebook OAuthè¨­å®š
VITE_INSTAGRAM_APP_ID=1003724798254754
VITE_INSTAGRAM_APP_SECRET=14ad79e7973687a6e3f803024caaf5b9
VITE_INSTAGRAM_REDIRECT_URI=https://instagram-marketing-app.vercel.app/auth/facebook/callback

# APIè¨­å®š
VITE_API_BASE_URL=https://instagram-marketing-backend-v2.onrender.com/api
VITE_API_URL=https://api.myservice.com

# OpenAI APIè¨­å®š
VITE_OPENAI_API_KEY=sk-your-actual-openai-api-key-here
OPENAI_API_KEY=sk-your-actual-openai-api-key-here

# PWAè¨­å®š
VITE_APP_NAME=Instagram Marketing App
VITE_APP_DESCRIPTION=AIãŒã‚ãªãŸã®SNSæŠ•ç¨¿ã‚’åˆ†æã—ã€æœ€é©ãªæŠ•ç¨¿å†…å®¹ã‚’ææ¡ˆã™ã‚‹ãƒ„ãƒ¼ãƒ«
```

### 3. Meta Developer Consoleè¨­å®š

#### å¿…é ˆè¨­å®šé …ç›®
1. **Facebook Login for Businessè¿½åŠ **
2. **Valid OAuth redirect URIs**:
   ```
   é–‹ç™ºç’°å¢ƒ: http://localhost:3001/auth/facebook/callback
   æœ¬ç•ªç’°å¢ƒ: https://instagram-marketing-app.vercel.app/auth/facebook/callback
   ```

#### å¿…è¦ãªæ¨©é™
- `instagram_basic`
- `instagram_content_publish`
- `instagram_manage_comments`
- `instagram_manage_insights`
- `pages_show_list`
- `pages_read_engagement`

## ğŸ”§ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- **React 18** + **TypeScript**
- **Vite** (ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«)
- **Zustand** (çŠ¶æ…‹ç®¡ç†)
- **React Router** (ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
- **Tailwind CSS** (ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°)
- **PWAå¯¾å¿œ** (Service Worker + Manifest)

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- **Node.js** + **Express**
- **MongoDB Atlas** (ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹)
- **OpenAI API** (AIæ©Ÿèƒ½)
- **Jest + Supertest** (ãƒ†ã‚¹ãƒˆ)

### ãƒ‡ãƒ—ãƒ­ã‚¤
- **Vercel** (ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰)
- **Render** (ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰)
- **GitHub Actions** (CI/CD)

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
instagram-marketing-app/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/          # Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ ThreadsPostCreator.tsx  # ThreadsæŠ•ç¨¿ä½œæˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ ThreadsPostList.tsx     # ThreadsæŠ•ç¨¿ä¸€è¦§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ __tests__/              # ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
â”‚   â”‚       â””â”€â”€ ThreadsPostCreator.test.tsx
â”‚   â”œâ”€â”€ pages/              # ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ Login.tsx       # ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ï¼ˆFacebook Login for Businessï¼‰
â”‚   â”‚   â”œâ”€â”€ AuthCallback.tsx # èªè¨¼ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†
â”‚   â”‚   â””â”€â”€ ThreadsManagement.tsx   # Threadsç®¡ç†ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ store/              # ZustandçŠ¶æ…‹ç®¡ç†
â”‚   â”‚   â””â”€â”€ useAppStore.ts  # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹
â”‚   â””â”€â”€ services/           # APIã‚µãƒ¼ãƒ“ã‚¹
â”‚       â”œâ”€â”€ authService.ts  # èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆãƒ­ã‚°ã‚¹ãƒ†ãƒƒãƒ—å®Ÿè£…ï¼‰
â”‚       â””â”€â”€ threadsService.ts # Threads APIã‚µãƒ¼ãƒ“ã‚¹
â”œâ”€â”€ server/
â”‚   â””â”€â”€ routes/
â”‚       â””â”€â”€ threads.ts      # Threads APIãƒ«ãƒ¼ã‚¿ãƒ¼
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ threadsApi.test.ts  # çµ±åˆãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ public/                 # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ manifest.json      # PWA Manifest
â”‚   â”œâ”€â”€ service-worker.js  # PWA Service Worker
â”‚   â””â”€â”€ icons/             # PWAã‚¢ã‚¤ã‚³ãƒ³
â”œâ”€â”€ env.development         # é–‹ç™ºç’°å¢ƒå¤‰æ•°
â”œâ”€â”€ env.production          # æœ¬ç•ªç’°å¢ƒå¤‰æ•°
â”œâ”€â”€ vercel.json            # Vercelè¨­å®š
â”œâ”€â”€ jest.config.js         # Jestè¨­å®š
â”œâ”€â”€ run-tests.sh           # æœ¬ç•ªãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â””â”€â”€ README.md              # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```

## ğŸ” èªè¨¼ãƒ•ãƒ­ãƒ¼

### Facebook Login for Businessèªè¨¼

1. **èªè¨¼é–‹å§‹**
   ```javascript
   // Login.tsxã§Facebook OAuth URLæ§‹ç¯‰
   const facebookAuthUrl = `https://www.facebook.com/v23.0/dialog/oauth?client_id=${facebookAppId}&display=page&extras=${encodeURIComponent('{"setup":{"channel":"IG_API_ONBOARDING"}}')}&redirect_uri=${encodeURIComponent(finalRedirectUri)}&response_type=token&scope=instagram_basic,instagram_content_publish,instagram_manage_comments,instagram_manage_insights,pages_show_list,pages_read_engagement`;
   ```

2. **ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—**
   ```javascript
   // AuthCallback.tsxã§ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆï¼ˆ#ï¼‰ã‹ã‚‰ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—
   const hash = window.location.hash.substring(1);
   const urlParams = new URLSearchParams(hash);
   const accessToken = urlParams.get('access_token');
   const longLivedToken = urlParams.get('long_lived_token');
   ```

3. **Instagram Business Accountå–å¾—**
   ```javascript
   // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã§Pagesã¨Instagram Business Accountå–å¾—
   const pagesResponse = await fetch(`https://graph.facebook.com/v23.0/me/accounts?fields=id,name,access_token,instagram_business_account&access_token=${userAccessToken}`);
   ```

## ğŸ“ ãƒ­ã‚°ã‚¹ãƒ†ãƒƒãƒ—ä»•æ§˜

### èªè¨¼ãƒ•ãƒ­ãƒ¼ãƒ­ã‚°
```
ğŸ“¸ [AUTH STEP 1] Facebook Login for Businessèªè¨¼é–‹å§‹
âœ… [AUTH STEP 2] Facebookèªè¨¼æˆåŠŸ
ğŸ“¸ [AUTH STEP 3] Instagram Mediaå–å¾—é–‹å§‹
âœ… [AUTH STEP 4] Instagram Mediaå–å¾—æˆåŠŸ
```

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚¢ã‚¯ã‚»ã‚¹
```

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### âœ… è§£æ±ºæ¸ˆã¿å•é¡Œ

#### SPAãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°404ã‚¨ãƒ©ãƒ¼ï¼ˆè§£æ±ºæ¸ˆã¿ï¼‰
- **å•é¡Œ**: `/threads-management`ãªã©ã®ãƒ«ãƒ¼ãƒˆã«ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã§404ã‚¨ãƒ©ãƒ¼
- **è§£æ±º**: vercel.jsonã®rewritesè¨­å®šã§å…¨ãƒ«ãƒ¼ãƒˆã‚’`/index.html`ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
- **ç¢ºèªæ¸ˆã¿**: æœ¬ç•ªç’°å¢ƒã§å…¨ãƒ«ãƒ¼ãƒˆãŒæ­£å¸¸ã«å‹•ä½œ

#### æŠ•ç¨¿æ™‚é–“åˆ†ææ©Ÿèƒ½ï¼ˆå®Ÿè£…å®Œäº†ï¼‰
- **æ©Ÿèƒ½**: ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡ãƒ™ãƒ¼ã‚¹ã®ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—è¡¨ç¤º
- **å®Ÿè£…**: PostingTimeHeatmapã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€åˆ†æã‚µãƒ¼ãƒ“ã‚¹
- **ç¢ºèªæ¸ˆã¿**: ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã§æ­£å¸¸å‹•ä½œ

### Instagramé€£æº404ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ

1. **Meta Developer Consoleè¨­å®šç¢ºèª**
   - Facebook Login for BusinessãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹
   - Valid OAuth redirect URIsãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹
   - å¿…è¦ãªæ¨©é™ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹

2. **ç’°å¢ƒå¤‰æ•°ç¢ºèª**
   - `VITE_INSTAGRAM_APP_ID`ãŒæ­£ã—ã„ã‹
   - `VITE_INSTAGRAM_REDIRECT_URI`ãŒæ­£ã—ã„ã‹

3. **Vercelè¨­å®šç¢ºèª**
   - `vercel.json`ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®šãŒæ­£ã—ã„ã‹
   - `/auth/facebook/callback`ãŒ`/`ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã‹

4. **ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢**
   - å¤ã„è¨­å®šãŒã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§

### ã‚ˆãã‚ã‚‹å•é¡Œ

- **ã€ŒInvalid platform appã€ã‚¨ãƒ©ãƒ¼**: App IDã®ä¸ä¸€è‡´
- **ã€ŒURL blockedã€ã‚¨ãƒ©ãƒ¼**: Meta Developer Consoleã®è¨­å®šä¸å‚™
- **ã€Œèªè¨¼ã‚¨ãƒ©ãƒ¼ã€**: ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯URLã®è¨­å®šãƒŸã‚¹

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

### ç·Šæ€¥æ™‚ã®é€£çµ¡å…ˆ
1. **HANDOVER_REPORT_20250730_FINAL.md**ã‚’ç¢ºèª
2. **Meta Developer Console**è¨­å®šã‚’ç¢ºèª
3. **ç’°å¢ƒå¤‰æ•°**ã®æ•´åˆæ€§ã‚’ç¢ºèª
4. **ãƒ­ã‚°ã‚¹ãƒ†ãƒƒãƒ—**ã§å•é¡Œã‚’ç‰¹å®š

### å‚è€ƒè³‡æ–™
- [Facebook Login for Business Documentation](https://developers.facebook.com/docs/instagram-basic-display-api/guides/getting-started)
- [Meta Developer Console](https://developers.facebook.com/)
- [Vercel Documentation](https://vercel.com/docs)

## ğŸ“Š æœ¬ç•ªç’°å¢ƒå‹•ä½œç¢ºèªçµæœï¼ˆ2025-08-03ï¼‰

### âœ… SPAãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ç¢ºèªæ¸ˆã¿
- `/threads-management` â†’ âœ… 200 OK
- `/posting-time-analysis` â†’ âœ… 200 OK  
- `/non-existent-route` â†’ âœ… 200 OKï¼ˆSPA NotFoundè¡¨ç¤ºï¼‰
- `/auth/facebook/callback` â†’ âœ… 200 OK

### âœ… PWAæ©Ÿèƒ½ç¢ºèªæ¸ˆã¿
- manifest.json â†’ âœ… æ­£å¸¸é…ä¿¡
- service-worker.js â†’ âœ… æ­£å¸¸é…ä¿¡
- ãƒ›ãƒ¼ãƒ ç”»é¢è¿½åŠ å¯èƒ½ â†’ âœ… ç¢ºèªæ¸ˆã¿

### âœ… æ–°æ©Ÿèƒ½ç¢ºèªæ¸ˆã¿
- æŠ•ç¨¿æ™‚é–“åˆ†æãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ— â†’ âœ… å‹•ä½œç¢ºèªæ¸ˆã¿
- æœ€é©æŠ•ç¨¿æ™‚é–“æ¨å¥¨ â†’ âœ… å‹•ä½œç¢ºèªæ¸ˆã¿

---

**ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯Facebook Login for Businessã‚’ä½¿ç”¨ã—ã¦Instagram Business Accountã¨é€£æºã—ã¾ã™ã€‚Meta Developer Consoleã®è¨­å®šãŒé‡è¦ã§ã™ã€‚**

**ğŸ‰ æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†ãƒ»å…¨æ©Ÿèƒ½å‹•ä½œç¢ºèªæ¸ˆã¿**
