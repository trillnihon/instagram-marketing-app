# Instagram Marketing App èªè¨¼ã‚¨ãƒ©ãƒ¼è§£æ¶ˆ ä¿®æ­£å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ

## ğŸ“‹ ä¿®æ­£æ¦‚è¦

å¼•ãç¶™ãæ›¸ã«åŸºã¥ãã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒç›´æ¥Graph APIã‚’å‘¼ã³å‡ºã™å•é¡Œã‚’è§£æ±ºã—ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰çµŒç”±ã§ã®çµ±ä¸€çš„ãªãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚

## ğŸ”§ ä¿®æ­£å†…å®¹

### 1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä¿®æ­£ï¼ˆsrc/services/instagramAuth.tsï¼‰

#### ä¿®æ­£å‰
```typescript
// Graph APIç›´å©ã
const url = `https://graph.facebook.com/v19.0/me?fields=id,name&access_token=${accessToken}`;
```

#### ä¿®æ­£å¾Œ
```typescript
// ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰çµŒç”±
const apiBaseUrl = import.meta.env.VITE_API_BASE_URL || '';
const url = `${apiBaseUrl}/instagram/user-info?accessToken=${accessToken}`;
```

#### ä¿®æ­£ç®‡æ‰€
- `validateToken()` ãƒ¡ã‚½ãƒƒãƒ‰
- `getInstagramAccountInfo()` ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆæ–¹æ³•1ï¼‰
- `getInstagramPosts()` ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆæ–¹æ³•1ï¼‰

### 2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä¿®æ­£ï¼ˆsrc/components/AccountAnalytics.tsxï¼‰

#### ä¿®æ­£å‰
```typescript
const apiUrl = `https://graph.facebook.com/v19.0/${safeInstagramBusinessAccountId}?fields=id,username,media_count,followers_count,follows_count&access_token=${safeAccessToken}`;
const response = await apiClient.get(apiUrl);
```

#### ä¿®æ­£å¾Œ
```typescript
const apiBaseUrl = import.meta.env.VITE_API_BASE_URL || '';
const apiUrl = `${apiBaseUrl}/instagram/user-info?accessToken=${safeAccessToken}`;
const response = await fetch(apiUrl);
```

### 3. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ä¿®æ­£ï¼ˆserver/routes/instagram-api.jsï¼‰

#### æ–°è¦è¿½åŠ ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
```javascript
router.get("/user-info", async (req, res) => {
  try {
    const { accessToken } = req.query;
    if (!accessToken) {
      return res.status(400).json({ success: false, error: "ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ãŒå¿…è¦ã§ã™" });
    }

    const url = `https://graph.facebook.com/v19.0/me?fields=id,name&access_token=${accessToken}`;
    const response = await axios.get(url);

    return res.json({ success: true, data: response.data });
  } catch (err) {
    console.error("[Instagram User Info Error]", err.response?.data || err.message);
    return res.json({ success: false, error: err.message });
  }
});
```

#### è¿½åŠ ã•ã‚ŒãŸä¾å­˜é–¢ä¿‚
- `axios` ã‚¤ãƒ³ãƒãƒ¼ãƒˆè¿½åŠ 

## âœ… å‹•ä½œç¢ºèªé …ç›®

### 1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIç¢ºèª
- [ ] `/api/instagram/user-info?accessToken=...` ãŒ 200 OK ã‚’è¿”ã™
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼ãŒ `{ success: true, data: { id, name } }` ã§ã‚ã‚‹
- [ ] ã‚¨ãƒ©ãƒ¼æ™‚ã¯ `{ success: false, error: "..." }` ã‚’è¿”ã™

### 2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç¢ºèª
- [ ] `/analytics` ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹
- [ ] æŠ•ç¨¿åˆ†æãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ã€Œèªè¨¼ã‚¨ãƒ©ãƒ¼ã€ãŒè¡¨ç¤ºã•ã‚Œãªã„
- [ ] ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚¨ãƒ©ãƒ¼ãŒå‡ºåŠ›ã•ã‚Œãªã„

### 3. ç’°å¢ƒå¤‰æ•°ç¢ºèª
- [ ] `VITE_API_BASE_URL` ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] é–‹ç™ºç’°å¢ƒ: `http://localhost:4000/api`
- [ ] æœ¬ç•ªç’°å¢ƒ: `https://instagram-marketing-backend-v2.onrender.com/api`

## ğŸ§ª ãƒ†ã‚¹ãƒˆæ–¹æ³•

### 1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIãƒ†ã‚¹ãƒˆ
```bash
# ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ
node test-user-info-api.js
```

### 2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# /analytics ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹
# ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç¢ºèª
```

## ğŸ“ ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

1. `src/services/instagramAuth.ts` - Graph APIç›´å©ãã‚’ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰çµŒç”±ã«å¤‰æ›´
2. `src/components/AccountAnalytics.tsx` - ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±å–å¾—ã‚’ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰çµŒç”±ã«å¤‰æ›´
3. `server/routes/instagram-api.js` - `/user-info` ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
4. `server/services/instagram-api.js` - `getUserInfo` ãƒ¡ã‚½ãƒƒãƒ‰ä¿®æ­£

## ğŸ¯ æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ

1. **ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ã®çµ±ä¸€**: ã™ã¹ã¦ã®Graph APIå‘¼ã³å‡ºã—ãŒãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰çµŒç”±ã«çµ±ä¸€
2. **èªè¨¼ã‚¨ãƒ©ãƒ¼ã®è§£æ¶ˆ**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã€Œèªè¨¼ã‚¨ãƒ©ãƒ¼ã€è¡¨ç¤ºãŒè§£æ¶ˆ
3. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å‘ä¸Š**: ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ãŒãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«éœ²å‡ºã—ãªã„
4. **ä¿å®ˆæ€§å‘ä¸Š**: ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ãƒ­ã‚¸ãƒƒã‚¯ãŒãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«é›†ç´„

## âš ï¸ æ³¨æ„äº‹é …

1. ç’°å¢ƒå¤‰æ•° `VITE_API_BASE_URL` ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
3. ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ãŒæœ‰åŠ¹ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª

## ğŸ“… ä¿®æ­£æ—¥æ™‚

- ä¿®æ­£å®Œäº†: 2025å¹´1æœˆ13æ—¥
- ä¿®æ­£è€…: AI Assistant
- ä¿®æ­£å†…å®¹: èªè¨¼ã‚¨ãƒ©ãƒ¼è§£æ¶ˆã®ãŸã‚ã®Graph APIå‘¼ã³å‡ºã—çµ±ä¸€åŒ–
