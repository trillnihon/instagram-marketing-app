# Instagram連携テスト手順書

## 🧪 テスト概要

### 目的
- Instagram OAuth認証フローの動作確認
- 404エラー解決の確認
- 環境変数の整合性確認

### テスト環境
- **開発サーバー**: `http://localhost:3001`
- **バックエンド**: `https://instagram-marketing-backend-v2.onrender.com`
- **フロントエンド**: `https://instagram-marketing-app.vercel.app`

## 📋 テスト手順

### 1. 開発環境でのテスト

#### 手順
1. **開発サーバー起動**
   ```bash
   npm run dev
   # http://localhost:3001 でアクセス
   ```

2. **ログイン画面にアクセス**
   ```
   http://localhost:3001/login
   ```

3. **Instagram認証ボタンをクリック**
   - 「Instagram (デモ)」ボタンをクリック
   - Instagram OAuth URLにリダイレクトされることを確認

4. **認証フローの確認**
   - Instagram認証ページが表示される
   - 認証後、コールバックURLにリダイレクト
   - `http://localhost:3001/auth/instagram/callback` で処理

5. **コールバック処理の確認**
   - AuthCallbackコンポーネントが正常に表示される
   - 認証成功後にダッシュボードにリダイレクト

### 2. 本番環境でのテスト

#### 手順
1. **本番環境にアクセス**
   ```
   https://instagram-marketing-app.vercel.app/login
   ```

2. **Instagram認証ボタンをクリック**
   - 本番環境でのOAuthフローを確認

3. **コールバック処理の確認**
   - `https://instagram-marketing-app.vercel.app/auth/instagram/callback` で処理

## 🔍 確認ポイント

### 開発環境
- ✅ **404エラー**: アイコンファイルの404エラーが解決されているか
- ✅ **OAuth URL**: 正しいInstagram OAuth URLが生成されるか
- ✅ **コールバック**: 認証後、正しくコールバック処理されるか
- ✅ **リダイレクト**: ダッシュボードに正常にリダイレクトされるか

### 本番環境
- ✅ **Vercel設定**: SPAルーティングが正常に動作するか
- ✅ **環境変数**: 正しいURLが設定されているか
- ✅ **バックエンド連携**: API通信が正常に動作するか

## 🐛 想定される問題と対処法

### 1. 404エラーが発生した場合
- **原因**: アイコンファイルの参照問題
- **対処法**: `index.html`のアイコン設定を確認

### 2. OAuth URLが正しく生成されない場合
- **原因**: 環境変数の設定問題
- **対処法**: `env.development`と`env.production`を確認

### 3. コールバック処理でエラーが発生した場合
- **原因**: AuthCallbackコンポーネントの問題
- **対処法**: コンソールログを確認してデバッグ

### 4. バックエンド通信エラーが発生した場合
- **原因**: CORS設定またはAPI URLの問題
- **対処法**: バックエンドの状態を確認

## 📊 テスト結果記録

### 開発環境テスト結果
- [ ] 404エラー解決確認
- [ ] Instagram OAuth URL生成確認
- [ ] コールバック処理確認
- [ ] ダッシュボードリダイレクト確認

### 本番環境テスト結果
- [ ] Vercel SPAルーティング確認
- [ ] 環境変数整合性確認
- [ ] バックエンド連携確認
- [ ] エラーハンドリング確認

## 🎯 成功基準

### 開発環境
1. **404エラーなし**: コンソールに404エラーが表示されない
2. **OAuthフロー正常**: Instagram認証ページに正常にリダイレクト
3. **コールバック成功**: 認証後、ダッシュボードに正常にリダイレクト
4. **エラーハンドリング**: 適切なエラーメッセージが表示される

### 本番環境
1. **SPAルーティング**: すべてのルートが正常に動作
2. **環境変数**: 正しいURLが設定されている
3. **API通信**: バックエンドとの通信が正常
4. **ユーザビリティ**: ユーザーがスムーズに操作できる

## 📝 テスト実行時の注意事項

1. **ブラウザの開発者ツール**: コンソールとネットワークタブを確認
2. **キャッシュクリア**: 必要に応じてブラウザキャッシュをクリア
3. **複数ブラウザ**: Chrome、Firefox、Safariでテスト
4. **モバイル対応**: スマートフォンでもテスト 