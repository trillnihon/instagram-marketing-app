# Facebookアプリ状態確認と解決手順

## 🚨 現在のエラー
```
機能をご利用いただけません
このアプリの詳細について追加アップデート中のため、Facebookログインはこのアプリでは利用できません。後ほどもう一度お試しください。
```

## 🔍 原因と解決方法

### 原因1: アプリの審査状態
Facebookアプリが審査中または一時停止状態になっている可能性があります。

### 解決手順1: Facebook開発者コンソールでの確認

#### 1.1 アプリの状態確認
```
https://developers.facebook.com/apps/1193533602546658
```

**確認項目:**
- [ ] **アプリモード**: 開発モードになっているか
- [ ] **アプリの状態**: アクティブになっているか
- [ ] **必要なアクション**: 保留中のアクションがないか

#### 1.2 アプリ設定の確認
**「アプリの設定」** → **「基本設定」**で以下を確認：

**必須項目:**
- [ ] **アプリ名**: "Caption AI Tool"
- [ ] **アプリドメイン**: 正しく設定されているか
- [ ] **プライバシーポリシーURL**: 設定されているか
- [ ] **利用規約URL**: 設定されているか

#### 1.3 プラットフォーム設定の確認
**「アプリの設定」** → **「プラットフォーム」**で以下を確認：

**Webサイト設定:**
- [ ] **サイトURL**: `https://instagram-marketing-app.vercel.app`
- [ ] **アプリドメイン**: `instagram-marketing-app.vercel.app`

**Facebookログイン設定:**
- [ ] **有効なOAuthリダイレクトURI**: `https://instagram-marketing-app.vercel.app/auth/callback`

### 解決手順2: アプリの再アクティベーション

#### 2.1 アプリの状態をリセット
1. **Facebook開発者コンソール**にアクセス
2. **「アプリの設定」** → **「基本設定」**
3. **「アプリの状態」**を確認
4. 必要に応じて**「アプリを再アクティベート」**をクリック

#### 2.2 テストユーザーの確認
1. **「アプリの役割」** → **「テストユーザー」**
2. **trill.0310.0321@gmail.com**が追加されているか確認
3. 追加されていない場合は**「テストユーザーを追加」**

### 解決手順3: 代替認証方法

#### 3.1 デモモードでのテスト
アプリが正常に動作することを確認：
```
https://instagram-marketing-app.vercel.app
```

#### 3.2 手動トークン取得
Facebook Graph API Explorerを使用：
```
https://developers.facebook.com/tools/explorer/
```

**手順:**
1. **アプリを選択**: "Caption AI Tool"
2. **ユーザートークンを生成**
3. **必要な権限を追加**:
   - `email`
   - `instagram_basic`
   - `instagram_manage_insights`
   - `public_profile`
   - `pages_show_list`
   - `pages_read_engagement`
4. **「トークンを生成」**をクリック

### 解決手順4: アプリの再作成（最終手段）

#### 4.1 新しいアプリの作成
1. **Facebook開発者コンソール**で**「アプリを作成」**
2. **「ビジネス」**を選択
3. **アプリ名**: "Instagram Marketing Tool v2"

#### 4.2 設定の移行
新しいアプリに以下の設定を移行：
- **プラットフォーム設定**
- **権限設定**
- **リダイレクトURI**

## 📋 確認チェックリスト

### Facebook開発者コンソール
- [ ] アプリがアクティブ状態
- [ ] 開発モードが有効
- [ ] 必要な権限が付与済み
- [ ] リダイレクトURIが正しく設定
- [ ] テストユーザーが追加済み

### アプリ設定
- [ ] アプリ名が正しく設定
- [ ] プライバシーポリシーが設定
- [ ] 利用規約が設定
- [ ] サイトURLが正しく設定

### 認証設定
- [ ] OAuthリダイレクトURIが正しく設定
- [ ] アプリドメインが正しく設定
- [ ] 必要な権限がすべて付与

## 🚀 次のステップ

### 即座に実行
1. **Facebook開発者コンソール**でアプリの状態を確認
2. **アプリの設定**を確認・修正
3. **テストユーザー**を追加

### 1時間以内
1. **アプリの再アクティベーション**を試行
2. **手動トークン取得**でテスト

### 24時間以内
1. **アプリの再作成**を検討
2. **新しい認証フロー**の実装

---

**作成日**: 2025年7月29日  
**ステータス**: 解決中  
**優先度**: 高 